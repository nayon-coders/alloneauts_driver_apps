import 'package:cloud_firestore/cloud_firestore.dart';import 'package:driver/Firebase/controller/auth_controller.dart';import 'package:driver/utilitys/colors.dart';import 'package:driver/view/auth/login.dart';import 'package:driver/view/setting/screens/payment_history.dart';import 'package:driver/view/setting/screens/request_vehicle_list.dart';import 'package:driver/view/setting/widgets/profile_menus.dart';import 'package:driver/view/verification_center/account_vefiy.dart';import 'package:driver/view/verification_center/email_verification.dart';import 'package:driver/widgets/alert.dart';import 'package:driver/widgets/appButton.dart';import 'package:driver/widgets/app_network_image.dart';import 'package:firebase_auth/firebase_auth.dart';import 'package:flutter/cupertino.dart';import 'package:flutter/material.dart';import '../../../widgets/login-required.dart';import '../../../widgets/un_authonticate_user.dart';import 'change_info.dart';import 'change_passwor.dart';import 'my_car.dart';class MySettings extends StatefulWidget {  const MySettings({Key? key}) : super(key: key);  @override  State<MySettings> createState() => _MySettingsState();}class _MySettingsState extends State<MySettings> {   final FirebaseAuth _auth = FirebaseAuth.instance;   final FirebaseFirestore _firestore = FirebaseFirestore.instance;  ///  ///============ get user profile  bool isEmailVerify = false;  bool isPhoneVerify = false;  bool isAccountVerify = false;  bool isLoading = false;  @override  void initState() {    // TODO: implement initState    super.initState();  }  @override  Widget build(BuildContext context) {    var size = MediaQuery.of(context).size;     return _auth.currentUser == null        ? const LoginRequired(text: "To access setting you need to login first.",)        :    StreamBuilder(        stream: _firestore.collection('drivers_profile').doc(_auth.currentUser!.email).snapshots(),        builder: (context, snapshot) {          if(snapshot.connectionState == ConnectionState.waiting){            return const Center(child: CircularProgressIndicator(color: AppColors.mainColor,),);          }else if(snapshot.hasData){            print("dadadsf=== ${snapshot.data!.data()}");            return snapshot.data!.data() != null                ? SingleChildScrollView(              padding: EdgeInsets.all(20),              child: Column(                mainAxisAlignment: MainAxisAlignment.start,                crossAxisAlignment: CrossAxisAlignment.start,                children: [                  Text("My Profile",                    style: TextStyle(                        fontWeight: FontWeight.w600,                        fontSize: 20,                        color: AppColors.black                    ),                  ),                  SizedBox(height: 20,),                  StreamBuilder(                    stream: AuthController.getDriverProfile(),                    builder: (context, snapshot) {                      if(snapshot.connectionState == ConnectionState.waiting){                        return Center(child: CircularProgressIndicator(color: AppColors.mainColor,),);                      }else if(snapshot.hasData){                        return Center(                          child: ClipRRect(                            borderRadius: BorderRadius.circular(100),                            child: snapshot.data["profile"] != null ? AppNetWorkImage(url: "${snapshot.data["profile"]}", height: 150, width: 150) : Image.asset("assets/images/profile.jpg", height: 150, width: 150,),                          ),                        );                      }else{                        return Center();                      }                    }                  ),                  ///                  ///                  ///                  ///======== verification center ====================                  SizedBox(height: 20,),                  const Text("Verification Center",                    style: TextStyle(                        fontWeight: FontWeight.w600,                        fontSize: 19,                        color: AppColors.black                    ),                  ),                  ProfileMenus(                    leadingIcon: Icons.email_outlined,                    onClick: ()=>Navigator.push(context, MaterialPageRoute(builder: (context)=>EmailVerification(email: _auth!.currentUser!.email!,))),                    trailingIcon: Icons.verified_user,                    trailingIconColor: snapshot.data!.data()!["email_verify"] == "1" ? Colors.green : Colors.red,                    text: "Email Verify",                  ),                  ProfileMenus(                    leadingIcon: Icons.phone_android,                    onClick: (){                      AppAler.showMyDialog(                          message: "We are sorry to say. Currently we are working on it. You can continue with out that.",                          context: context,                          icon: Icons.phone_android,                          onClick: (){                            Navigator.pop(context);                          }                      );                    },                    // onClick: ()=>Navigator.push(context, MaterialPageRoute(builder: (context)=>AccountVerification())),                    trailingIcon: Icons.verified_user,                    trailingIconColor: snapshot.data!.data()!["phone_verify"] == "0" ? Colors.red : Colors.green,                    text: "Phone Number Verify",                  ),                  ProfileMenus(                    leadingIcon: Icons.account_box_rounded,                    onClick: ()=>Navigator.push(context, MaterialPageRoute(builder: (context)=>AccountVerification())),                    trailingIcon: Icons.verified_user,                    trailingIconColor: snapshot.data!.data()!["account_verify"] == "0" ? Colors.red : Colors.green,                    text: "Account Verify",                  ),                  SizedBox(height: 20,),                  Text("Services",                    style: TextStyle(                        fontWeight: FontWeight.w600,                        fontSize: 19,                        color: AppColors.black                    ),                  ),                  ProfileMenus(                    leadingIcon: CupertinoIcons.car,                    onClick: ()=>Navigator.push(context, MaterialPageRoute(builder: (context)=>RequestVehiclesList())),                    text: "Request Vehicle's",                  ),                  ProfileMenus(                    leadingIcon: CupertinoIcons.car,                    onClick: ()=>Navigator.push(context, MaterialPageRoute(builder: (context)=>MyCar())),                    text: "My Vehicle",                  ),                  ProfileMenus(                    leadingIcon: CupertinoIcons.money_dollar_circle,                    onClick: ()=>Navigator.push(context, MaterialPageRoute(builder: (context)=>PaymentHistory())),                    text: "Payment History",                  ),                  SizedBox(height: 20,),                  Text("Settings",                    style: TextStyle(                        fontWeight: FontWeight.w600,                        fontSize: 19,                        color: AppColors.black                    ),                  ),                  SizedBox(height: 10,),                  ProfileMenus(                    leadingIcon: Icons.person,                    onClick: ()=>Navigator.push(context, MaterialPageRoute(builder: (context)=>ChangeInfo())),                    text: "Change Information",                  ),                  ProfileMenus(                    leadingIcon: Icons.key,                    onClick: ()=>Navigator.push(context, MaterialPageRoute(builder: (context)=> ChangePassword())),                    text: "Change Password",                  ),                  // ProfileMenus(                  //   leadingIcon: Icons.notifications_active,                  //   onClick: (){},                  //   text: "Notification Setting",                  // ),                  ProfileMenus(                    leadingIcon: Icons.logout,                    onClick: (){                      AppAler.showMyDialog(                          message: "Are you sure? You want to logout?",                          context: context,                          icon: Icons.logout,                          onClick: (){                            AuthController.signOut(context);                          }                      );                    },                    text: "Logout Out",                  ),                  ProfileMenus(                    leadingIcon: Icons.logout,                    onClick: (){                      AppAler.showMyDialog(                          message: "Are you sure? You want to delete your account? If you delete your account, you all data will be gone.",                          context: context,                          icon: Icons.delete,                          onClick: (){                            AuthController.deleteAccount(context);                          }                      );                    },                    text: "Delete Account",                  )                ],              ),            )                : const LoginRequired(text: "To access setting you need to login first.",);          }else{            return Center(child: Text("Something went wrong with Server"),);          }        }    );  }}